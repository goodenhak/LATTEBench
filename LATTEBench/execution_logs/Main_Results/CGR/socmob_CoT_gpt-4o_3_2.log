2025-10-13 20:08:43,062 - INFO - ========== START ==========
2025-10-13 20:08:43,062 - INFO - Arguments: {'log_path': './log', 'log_filename': 'socmob_CoT_gpt-4o_3_2.log', 'data_name': 'socmob', 'output_format': 'cRPN', 'llm_model': 'gpt-4o', 'nl2code': '', 'code_model': 'deepseek-chat', 'enlarge_num': 3, 'iter': 10, 'task_type': 1, 'seed': 2, 'test_size': 0.2, 'val_size': 0.2, 'ensemble': 1, 'sample_size': 4, 'sample_method': 1, 'demo_format': 0, 'op_type': 2, 'metadata_cat': 3, 'max_tokens': 8192, 'temperature': 1.0}
2025-10-13 20:08:43,448 - INFO - val_acc = 0.9393939393939394
2025-10-13 20:08:43,449 - INFO - test_acc = 0.9439655172413793
2025-10-13 20:08:43,449 - INFO - ========== Iteration 1/10 ==========
2025-10-13 20:08:43,459 - INFO - Initial prompt: You are an expert datascientist working to improve predictions. 
You perform feature engineering that generate additional columns that are useful for a downstream task.

Task: The aim of this dataset is to study The Effects of Family Disruption on Social Mobility. Predict the counts for son's current occupation. We converts the numeric target feature to a two-class nominal target feature by computing the mean and classifying all instances with a lower target value as positive ('P') and all others as negative ('N').

Features:
- fathers_occupation: father's occupation (categorical), categories = [Proprietor, Craftsman-Manufacturing, Manager, Salesman-Retail, Craftsman-Construction, Farmer/Farm_Manager, Operative-Manufacturing, Laborer-Nonmanufacturing, Clerk, Salesman-Nonretail, Craftsmen-Other, Service_Worker, Professional_Self-Employed, Laborer-Manufacturing, Operative-Nonmanufacturing, Professional-Salaried, Farm_Laborer]
- sons_occupation: son's occupation (categorical), categories = [Professional_Self-Employed, Craftsman-Construction, Professional-Salaried, Clerk, Farm_Laborer, Craftsman-Manufacturing, Laborer-Nonmanufacturing, Operative-Manufacturing, Service_Worker, Proprietor, Salesman-Nonretail, Craftsmen-Other, Manager, Farmer/Farm_Manager, Laborer-Manufacturing, Operative-Nonmanufacturing, Salesman-Retail]
- family_structure: family structure (categorical), categories = [intact, nonintact]
- race: race (categorical), categories = [black, white]
- counts_for_sons_first_occupation: counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers. (numerical), range = [0.0, 746.3], Q1 = 0.5, Median = 3.0, Q3 = 11.9, Mean = 19.3561, Std = 51.3517

Data Examples:
fathers_occupation is Craftsman-Manufacturing. sons_occupation is Salesman-Retail. family_structure is intact. race is white. counts_for_sons_first_occupation is 46.4.
Answer: 0
fathers_occupation is Operative-Manufacturing. sons_occupation is Craftsman-Manufacturing. family_structure is nonintact. race is white. counts_for_sons_first_occupation is 14.1.
Answer: 0
fathers_occupation is Proprietor. sons_occupation is Professional_Self-Employed. family_structure is nonintact. race is white. counts_for_sons_first_occupation is 1.5.
Answer: 1
fathers_occupation is Craftsman-Manufacturing. sons_occupation is Farmer/Farm_Manager. family_structure is intact. race is white. counts_for_sons_first_occupation is 7.3.
Answer: 1


Operators:
square, sqrt, cosine, sine, tangent, exp, cube, log, reciprocal, sigmoid, abs, negate, zscore, minmax, rank, bin, one_hot, label_encode, extract_time, is_weekend, elapsed_time, plus, subtract, multiply, divide, mod, equal, greater, less, max, min, cross, concat, ratio, diff, bin
rolling_mean, lag, cumsum, groupbythenmean, groupbythenmin, groupbythenmax, groupbythenmedian, groupbythenstd, groupbythenrank, target_encoding

2025-10-13 20:08:45,889 - INFO - HTTP Request: POST  "HTTP/1.1 200 OK"
2025-10-13 20:08:46,020 - INFO - Token Usage:{'prompt_tokens': 980, 'completion_tokens': 41, 'total_tokens': 1021}
2025-10-13 20:08:46,020 - INFO - LLM Output: {fathers_occupation label_encode sons_occupation label_encode minus abs, counts_for_sons_first_occupation intact family_structure equal cross, counts_for_sons_first_occupation race black equal cross}
2025-10-13 20:08:46,033 - INFO - 
--- RPN处理错误汇总 ---
2025-10-13 20:08:46,034 - INFO - - 警告: RPN1 特征 'rpn_1_feature_3' 处理失败，跳过。错误: 'minus'
2025-10-13 20:08:46,034 - INFO - - 警告: RPN2 特征 'rpn_2_feature_1' 处理失败，跳过。错误: 'intact'
2025-10-13 20:08:46,034 - INFO - - 警告: RPN2 特征 'rpn_2_feature_2' 处理失败，跳过。错误: 'rpn_2_feature_1'
2025-10-13 20:08:46,034 - INFO - - 警告: RPN3 特征 'rpn_3_feature_1' 处理失败，跳过。错误: could not convert string to float: 'black'
2025-10-13 20:08:46,034 - INFO - - 警告: RPN3 特征 'rpn_3_feature_2' 处理失败，跳过。错误: 'rpn_3_feature_1'
2025-10-13 20:08:46,035 - INFO - Success Operators:
[{'new_feature_name': 'rpn_1_feature_1', 'operator': 'label_encode', 'feature1': 'fathers_occupation', 'feature2': None, 'description': 'RPN1: label_encode(fathers_occupation)'}, {'new_feature_name': 'rpn_1_feature_2', 'operator': 'label_encode', 'feature1': 'sons_occupation', 'feature2': None, 'description': 'RPN1: label_encode(sons_occupation)'}]
2025-10-13 20:08:46,038 - INFO - 
--- RPN处理错误汇总 ---
2025-10-13 20:08:46,039 - INFO - - 警告: RPN1 特征 'rpn_1_feature_3' 处理失败，跳过。错误: 'minus'
2025-10-13 20:08:46,039 - INFO - - 警告: RPN2 特征 'rpn_2_feature_1' 处理失败，跳过。错误: 'intact'
2025-10-13 20:08:46,039 - INFO - - 警告: RPN2 特征 'rpn_2_feature_2' 处理失败，跳过。错误: 'rpn_2_feature_1'
2025-10-13 20:08:46,039 - INFO - - 警告: RPN3 特征 'rpn_3_feature_1' 处理失败，跳过。错误: could not convert string to float: 'black'
2025-10-13 20:08:46,039 - INFO - - 警告: RPN3 特征 'rpn_3_feature_2' 处理失败，跳过。错误: 'rpn_3_feature_1'
2025-10-13 20:08:46,046 - INFO - 
--- RPN处理错误汇总 ---
2025-10-13 20:08:46,046 - INFO - - 警告: RPN1 特征 'rpn_1_feature_3' 处理失败，跳过。错误: 'minus'
2025-10-13 20:08:46,046 - INFO - - 警告: RPN2 特征 'rpn_2_feature_1' 处理失败，跳过。错误: 'intact'
2025-10-13 20:08:46,046 - INFO - - 警告: RPN2 特征 'rpn_2_feature_2' 处理失败，跳过。错误: 'rpn_2_feature_1'
2025-10-13 20:08:46,046 - INFO - - 警告: RPN3 特征 'rpn_3_feature_1' 处理失败，跳过。错误: could not convert string to float: 'black'
2025-10-13 20:08:46,046 - INFO - - 警告: RPN3 特征 'rpn_3_feature_2' 处理失败，跳过。错误: 'rpn_3_feature_1'
2025-10-13 20:08:46,048 - INFO - Extracted Metadata: {'fathers_occupation': "father's occupation", 'sons_occupation': "son's occupation", 'family_structure': 'family structure', 'race': 'race', 'counts_for_sons_first_occupation': "counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers.", 'rpn_1_feature_1': 'RPN1: label_encode(fathers_occupation)', 'rpn_1_feature_2': 'RPN1: label_encode(sons_occupation)'}
2025-10-13 20:08:46,502 - INFO - new_val_acc = 0.9523809523809523
2025-10-13 20:08:46,502 - INFO - new_test_acc = 0.9525862068965517
2025-10-13 20:08:46,902 - INFO - dropped columns = []
2025-10-13 20:08:46,903 - INFO - ops_string = fathers_occupation label_encode sons_occupation label_encode minus abs, counts_for_sons_first_occupation intact family_structure equal cross, counts_for_sons_first_occupation race black equal cross
2025-10-13 20:08:46,903 - INFO - --- metadata updated! ---
2025-10-13 20:08:46,912 - INFO - Time used for iteration 1: 3.46 seconds
2025-10-13 20:08:46,912 - INFO - Total token usage = 1021
2025-10-13 20:08:46,912 - INFO - ========== Iteration 2/10 ==========
2025-10-13 20:08:46,924 - INFO - Initial prompt: You are an expert datascientist working to improve predictions. 
You perform feature engineering that generate additional columns that are useful for a downstream task.

Task: The aim of this dataset is to study The Effects of Family Disruption on Social Mobility. Predict the counts for son's current occupation. We converts the numeric target feature to a two-class nominal target feature by computing the mean and classifying all instances with a lower target value as positive ('P') and all others as negative ('N').

Features:
- fathers_occupation: father's occupation (categorical), categories = [Proprietor, Craftsman-Manufacturing, Manager, Salesman-Retail, Craftsman-Construction, Farmer/Farm_Manager, Operative-Manufacturing, Laborer-Nonmanufacturing, Clerk, Salesman-Nonretail, Craftsmen-Other, Service_Worker, Professional_Self-Employed, Laborer-Manufacturing, Operative-Nonmanufacturing, Professional-Salaried, Farm_Laborer]
- sons_occupation: son's occupation (categorical), categories = [Professional_Self-Employed, Craftsman-Construction, Professional-Salaried, Clerk, Farm_Laborer, Craftsman-Manufacturing, Laborer-Nonmanufacturing, Operative-Manufacturing, Service_Worker, Proprietor, Salesman-Nonretail, Craftsmen-Other, Manager, Farmer/Farm_Manager, Laborer-Manufacturing, Operative-Nonmanufacturing, Salesman-Retail]
- family_structure: family structure (categorical), categories = [intact, nonintact]
- race: race (categorical), categories = [black, white]
- counts_for_sons_first_occupation: counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers. (numerical), range = [0.0, 746.3], Q1 = 0.5, Median = 3.0, Q3 = 11.9, Mean = 19.3561, Std = 51.3517
- fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs:  (numerical), range = [0, 16], Q1 = 4.0, Median = 8.0, Q3 = 12.0, Mean = 7.7734, Std = 4.7979

Data Examples:
fathers_occupation is Operative-Manufacturing. sons_occupation is Manager. family_structure is nonintact. race is white. counts_for_sons_first_occupation is 8.0. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 8.
Answer: 0
fathers_occupation is Operative-Nonmanufacturing. sons_occupation is Professional-Salaried. family_structure is intact. race is white. counts_for_sons_first_occupation is 117.0. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 11.
Answer: 0
fathers_occupation is Salesman-Retail. sons_occupation is Operative-Manufacturing. family_structure is nonintact. race is white. counts_for_sons_first_occupation is 8.4. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 9.
Answer: 1
fathers_occupation is Craftsman-Manufacturing. sons_occupation is Farm_Laborer. family_structure is intact. race is white. counts_for_sons_first_occupation is 11.9. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 4.
Answer: 1


Operators:
square, sqrt, cosine, sine, tangent, exp, cube, log, reciprocal, sigmoid, abs, negate, zscore, minmax, rank, bin, one_hot, label_encode, extract_time, is_weekend, elapsed_time, plus, subtract, multiply, divide, mod, equal, greater, less, max, min, cross, concat, ratio, diff, bin
rolling_mean, lag, cumsum, groupbythenmean, groupbythenmin, groupbythenmax, groupbythenmedian, groupbythenstd, groupbythenrank, target_encoding

2025-10-13 20:08:47,937 - INFO - HTTP Request: POST  "HTTP/1.1 200 OK"
2025-10-13 20:08:47,939 - INFO - Token Usage:{'prompt_tokens': 1113, 'completion_tokens': 37, 'total_tokens': 1150}
2025-10-13 20:08:47,939 - INFO - LLM Output: {counts_for_sons_first_occupation sqrt, fathers_occupation sons_occupation cross label_encode, counts_for_sons_first_occupation race concat label_encode groupbythenmean}
2025-10-13 20:08:47,948 - INFO - 
--- RPN处理错误汇总 ---
2025-10-13 20:08:47,948 - INFO - - 警告: RPN3 处理失败，跳过整个RPN。错误: RPN 3: 二元运算符 groupbythenmean 操作数不足，需要至少2个操作数，当前栈中有 1 个
2025-10-13 20:08:47,950 - INFO - Success Operators:
[{'new_feature_name': 'rpn_1_feature_1', 'operator': 'sqrt', 'feature1': 'counts_for_sons_first_occupation', 'feature2': None, 'description': 'RPN1: sqrt(counts_for_sons_first_occupation)'}, {'new_feature_name': 'rpn_2_feature_1', 'operator': 'cross', 'feature1': 'fathers_occupation', 'feature2': 'sons_occupation', 'description': 'RPN2: fathers_occupation cross sons_occupation'}, {'new_feature_name': 'rpn_2_feature_2', 'operator': 'label_encode', 'feature1': 'rpn_2_feature_1', 'feature2': None, 'description': 'RPN2: label_encode(rpn_2_feature_1)'}]
2025-10-13 20:08:47,952 - INFO - 
--- RPN处理错误汇总 ---
2025-10-13 20:08:47,953 - INFO - - 警告: RPN3 处理失败，跳过整个RPN。错误: RPN 3: 二元运算符 groupbythenmean 操作数不足，需要至少2个操作数，当前栈中有 1 个
2025-10-13 20:08:47,957 - INFO - 
--- RPN处理错误汇总 ---
2025-10-13 20:08:47,957 - INFO - - 警告: RPN3 处理失败，跳过整个RPN。错误: RPN 3: 二元运算符 groupbythenmean 操作数不足，需要至少2个操作数，当前栈中有 1 个
2025-10-13 20:08:47,958 - INFO - Extracted Metadata: {'fathers_occupation': "father's occupation", 'sons_occupation': "son's occupation", 'family_structure': 'family structure', 'race': 'race', 'counts_for_sons_first_occupation': "counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers.", 'rpn_1_feature_1': 'RPN1: sqrt(counts_for_sons_first_occupation)', 'rpn_1_feature_2': 'RPN1: label_encode(sons_occupation)', 'rpn_2_feature_1': 'RPN2: fathers_occupation cross sons_occupation', 'rpn_2_feature_2': 'RPN2: label_encode(rpn_2_feature_1)'}
2025-10-13 20:08:48,368 - INFO - new_val_acc = 0.948051948051948
2025-10-13 20:08:48,368 - INFO - new_test_acc = 0.9612068965517241
2025-10-13 20:08:48,830 - INFO - dropped columns = ['fathers_occupation', 'fathers_occupation_sons_occupation_cross_label_encode']
2025-10-13 20:08:49,248 - INFO - sel_val_acc = 0.9567099567099567
2025-10-13 20:08:49,248 - INFO - sel_test_acc = 0.9741379310344828
2025-10-13 20:08:49,249 - INFO - ops_string = counts_for_sons_first_occupation sqrt, fathers_occupation sons_occupation cross label_encode, counts_for_sons_first_occupation race concat label_encode groupbythenmean
2025-10-13 20:08:49,249 - INFO - --- metadata updated! ---
2025-10-13 20:08:49,258 - INFO - Time used for iteration 2: 2.35 seconds
2025-10-13 20:08:49,258 - INFO - Total token usage = 2171
2025-10-13 20:08:49,258 - INFO - ========== Iteration 3/10 ==========
2025-10-13 20:08:49,272 - INFO - Initial prompt: You are an expert datascientist working to improve predictions. 
You perform feature engineering that generate additional columns that are useful for a downstream task.

Task: The aim of this dataset is to study The Effects of Family Disruption on Social Mobility. Predict the counts for son's current occupation. We converts the numeric target feature to a two-class nominal target feature by computing the mean and classifying all instances with a lower target value as positive ('P') and all others as negative ('N').

Features:
- counts_for_sons_first_occupation: counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers. (numerical), range = [0.0, 746.3], Q1 = 0.5, Median = 3.0, Q3 = 11.9, Mean = 19.3561, Std = 51.3517
- counts_for_sons_first_occupation_sqrt:  (numerical), range = [0.0, 27.31849190566712], Q1 = 0.7071067811865476, Median = 1.7320508075688772, Q3 = 3.449637662132068, Mean = 2.7840, Std = 3.4092
- race: race (categorical), categories = [black, white]
- fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs:  (numerical), range = [0, 16], Q1 = 4.0, Median = 8.0, Q3 = 12.0, Mean = 7.7734, Std = 4.7979
- sons_occupation: son's occupation (categorical), categories = [Professional_Self-Employed, Craftsman-Construction, Professional-Salaried, Clerk, Farm_Laborer, Craftsman-Manufacturing, Laborer-Nonmanufacturing, Operative-Manufacturing, Service_Worker, Proprietor, Salesman-Nonretail, Craftsmen-Other, Manager, Farmer/Farm_Manager, Laborer-Manufacturing, Operative-Nonmanufacturing, Salesman-Retail]
- family_structure: family structure (categorical), categories = [intact, nonintact]

Data Examples:
counts_for_sons_first_occupation is 36.2. counts_for_sons_first_occupation_sqrt is 6.016643582596529. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 14. sons_occupation is Salesman-Nonretail. family_structure is intact.
Answer: 0
counts_for_sons_first_occupation is 5.4. counts_for_sons_first_occupation_sqrt is 2.32379000772445. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 13. sons_occupation is Proprietor. family_structure is intact.
Answer: 0
counts_for_sons_first_occupation is 0.0. counts_for_sons_first_occupation_sqrt is 0.0. race is black. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 15. sons_occupation is Salesman-Retail. family_structure is intact.
Answer: 1
counts_for_sons_first_occupation is 3.4. counts_for_sons_first_occupation_sqrt is 1.8439088914585773. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 4. sons_occupation is Farm_Laborer. family_structure is nonintact.
Answer: 1


Operators:
square, sqrt, cosine, sine, tangent, exp, cube, log, reciprocal, sigmoid, abs, negate, zscore, minmax, rank, bin, one_hot, label_encode, extract_time, is_weekend, elapsed_time, plus, subtract, multiply, divide, mod, equal, greater, less, max, min, cross, concat, ratio, diff, bin
rolling_mean, lag, cumsum, groupbythenmean, groupbythenmin, groupbythenmax, groupbythenmedian, groupbythenstd, groupbythenrank, target_encoding

2025-10-13 20:08:50,672 - INFO - HTTP Request: POST  "HTTP/1.1 200 OK"
2025-10-13 20:08:50,673 - INFO - Token Usage:{'prompt_tokens': 1125, 'completion_tokens': 41, 'total_tokens': 1166}
2025-10-13 20:08:50,673 - INFO - LLM Output: {counts_for_sons_first_occupation counts_for_sons_first_occupation log ratio, family_structure race cross sons_occupation cross, counts_for_sons_first_occupation race label_encode plus sqrt}
2025-10-13 20:08:50,689 - INFO - Success Operators:
[{'new_feature_name': 'rpn_1_feature_1', 'operator': 'log', 'feature1': 'counts_for_sons_first_occupation', 'feature2': None, 'description': 'RPN1: log(counts_for_sons_first_occupation)'}, {'new_feature_name': 'rpn_1_feature_2', 'operator': 'ratio', 'feature1': 'counts_for_sons_first_occupation', 'feature2': 'rpn_1_feature_1', 'description': 'RPN1: counts_for_sons_first_occupation ratio rpn_1_feature_1'}, {'new_feature_name': 'rpn_2_feature_1', 'operator': 'cross', 'feature1': 'family_structure', 'feature2': 'race', 'description': 'RPN2: family_structure cross race'}, {'new_feature_name': 'rpn_2_feature_2', 'operator': 'cross', 'feature1': 'rpn_2_feature_1', 'feature2': 'sons_occupation', 'description': 'RPN2: rpn_2_feature_1 cross sons_occupation'}, {'new_feature_name': 'rpn_3_feature_1', 'operator': 'label_encode', 'feature1': 'race', 'feature2': None, 'description': 'RPN3: label_encode(race)'}, {'new_feature_name': 'rpn_3_feature_2', 'operator': 'plus', 'feature1': 'counts_for_sons_first_occupation', 'feature2': 'rpn_3_feature_1', 'description': 'RPN3: counts_for_sons_first_occupation plus rpn_3_feature_1'}, {'new_feature_name': 'rpn_3_feature_3', 'operator': 'sqrt', 'feature1': 'rpn_3_feature_2', 'feature2': None, 'description': 'RPN3: sqrt(rpn_3_feature_2)'}]
2025-10-13 20:08:50,705 - INFO - Extracted Metadata: {'sons_occupation': "son's occupation", 'family_structure': 'family structure', 'race': 'race', 'counts_for_sons_first_occupation': "counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers.", 'rpn_1_feature_1': 'RPN1: log(counts_for_sons_first_occupation)', 'rpn_1_feature_2': 'RPN1: counts_for_sons_first_occupation ratio rpn_1_feature_1', 'rpn_2_feature_1': 'RPN2: family_structure cross race', 'rpn_2_feature_2': 'RPN2: rpn_2_feature_1 cross sons_occupation', 'rpn_3_feature_1': 'RPN3: label_encode(race)', 'rpn_3_feature_2': 'RPN3: counts_for_sons_first_occupation plus rpn_3_feature_1', 'rpn_3_feature_3': 'RPN3: sqrt(rpn_3_feature_2)'}
2025-10-13 20:08:51,186 - INFO - new_val_acc = 0.9393939393939394
2025-10-13 20:08:51,186 - INFO - new_test_acc = 0.9698275862068966
2025-10-13 20:08:51,620 - INFO - dropped columns = ['counts_for_sons_first_occupation', 'counts_for_sons_first_occupation_sqrt', 'family_structure']
2025-10-13 20:08:51,958 - INFO - sel_val_acc = 0.9567099567099567
2025-10-13 20:08:51,958 - INFO - sel_test_acc = 0.9612068965517241
2025-10-13 20:08:51,958 - INFO - ops_string = counts_for_sons_first_occupation counts_for_sons_first_occupation log ratio, family_structure race cross sons_occupation cross, counts_for_sons_first_occupation race label_encode plus sqrt
2025-10-13 20:08:51,958 - INFO - Time used for iteration 3: 2.70 seconds
2025-10-13 20:08:51,958 - INFO - Total token usage = 3337
2025-10-13 20:08:51,958 - INFO - ========== Iteration 4/10 ==========
2025-10-13 20:08:51,970 - INFO - Initial prompt: You are an expert datascientist working to improve predictions. 
You perform feature engineering that generate additional columns that are useful for a downstream task.

Task: The aim of this dataset is to study The Effects of Family Disruption on Social Mobility. Predict the counts for son's current occupation. We converts the numeric target feature to a two-class nominal target feature by computing the mean and classifying all instances with a lower target value as positive ('P') and all others as negative ('N').

Features:
- counts_for_sons_first_occupation: counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers. (numerical), range = [0.0, 746.3], Q1 = 0.5, Median = 3.0, Q3 = 11.9, Mean = 19.3561, Std = 51.3517
- counts_for_sons_first_occupation_sqrt:  (numerical), range = [0.0, 27.31849190566712], Q1 = 0.7071067811865476, Median = 1.7320508075688772, Q3 = 3.449637662132068, Mean = 2.7840, Std = 3.4092
- race: race (categorical), categories = [black, white]
- fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs:  (numerical), range = [0, 16], Q1 = 4.0, Median = 8.0, Q3 = 12.0, Mean = 7.7734, Std = 4.7979
- sons_occupation: son's occupation (categorical), categories = [Professional_Self-Employed, Craftsman-Construction, Professional-Salaried, Clerk, Farm_Laborer, Craftsman-Manufacturing, Laborer-Nonmanufacturing, Operative-Manufacturing, Service_Worker, Proprietor, Salesman-Nonretail, Craftsmen-Other, Manager, Farmer/Farm_Manager, Laborer-Manufacturing, Operative-Nonmanufacturing, Salesman-Retail]
- family_structure: family structure (categorical), categories = [intact, nonintact]

Data Examples:
counts_for_sons_first_occupation is 11.1. counts_for_sons_first_occupation_sqrt is 3.331666249791536. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 3. sons_occupation is Craftsmen-Other. family_structure is nonintact.
Answer: 0
counts_for_sons_first_occupation is 40.8. counts_for_sons_first_occupation_sqrt is 6.387487769068525. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 7. sons_occupation is Laborer-Nonmanufacturing. family_structure is intact.
Answer: 0
counts_for_sons_first_occupation is 2.4. counts_for_sons_first_occupation_sqrt is 1.5491933384829668. race is black. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 10. sons_occupation is Operative-Nonmanufacturing. family_structure is nonintact.
Answer: 1
counts_for_sons_first_occupation is 0.0. counts_for_sons_first_occupation_sqrt is 0.0. race is black. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 8. sons_occupation is Manager. family_structure is intact.
Answer: 1


Operators:
square, sqrt, cosine, sine, tangent, exp, cube, log, reciprocal, sigmoid, abs, negate, zscore, minmax, rank, bin, one_hot, label_encode, extract_time, is_weekend, elapsed_time, plus, subtract, multiply, divide, mod, equal, greater, less, max, min, cross, concat, ratio, diff, bin
rolling_mean, lag, cumsum, groupbythenmean, groupbythenmin, groupbythenmax, groupbythenmedian, groupbythenstd, groupbythenrank, target_encoding

2025-10-13 20:08:53,714 - INFO - HTTP Request: POST  "HTTP/1.1 200 OK"
2025-10-13 20:08:53,715 - INFO - Token Usage:{'prompt_tokens': 1128, 'completion_tokens': 53, 'total_tokens': 1181}
2025-10-13 20:08:53,715 - INFO - LLM Output: {counts_for_sons_first_occupation counts_for_sons_first_occupation_sqrt divide log, race label_encode counts_for_sons_first_occupation multiply, sons_occupation fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs label_encode cross}
2025-10-13 20:08:53,735 - INFO - Success Operators:
[{'new_feature_name': 'rpn_1_feature_1', 'operator': 'divide', 'feature1': 'counts_for_sons_first_occupation', 'feature2': 'counts_for_sons_first_occupation_sqrt', 'description': 'RPN1: counts_for_sons_first_occupation divide counts_for_sons_first_occupation_sqrt'}, {'new_feature_name': 'rpn_1_feature_2', 'operator': 'log', 'feature1': 'rpn_1_feature_1', 'feature2': None, 'description': 'RPN1: log(rpn_1_feature_1)'}, {'new_feature_name': 'rpn_2_feature_1', 'operator': 'label_encode', 'feature1': 'race', 'feature2': None, 'description': 'RPN2: label_encode(race)'}, {'new_feature_name': 'rpn_2_feature_2', 'operator': 'multiply', 'feature1': 'rpn_2_feature_1', 'feature2': 'counts_for_sons_first_occupation', 'description': 'RPN2: rpn_2_feature_1 multiply counts_for_sons_first_occupation'}, {'new_feature_name': 'rpn_3_feature_1', 'operator': 'label_encode', 'feature1': 'fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs', 'feature2': None, 'description': 'RPN3: label_encode(fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs)'}, {'new_feature_name': 'rpn_3_feature_2', 'operator': 'cross', 'feature1': 'sons_occupation', 'feature2': 'rpn_3_feature_1', 'description': 'RPN3: sons_occupation cross rpn_3_feature_1'}]
2025-10-13 20:08:53,747 - INFO - Extracted Metadata: {'sons_occupation': "son's occupation", 'family_structure': 'family structure', 'race': 'race', 'counts_for_sons_first_occupation': "counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers.", 'rpn_1_feature_1': 'RPN1: counts_for_sons_first_occupation divide counts_for_sons_first_occupation_sqrt', 'rpn_1_feature_2': 'RPN1: log(rpn_1_feature_1)', 'rpn_2_feature_1': 'RPN2: label_encode(race)', 'rpn_2_feature_2': 'RPN2: rpn_2_feature_1 multiply counts_for_sons_first_occupation', 'rpn_3_feature_1': 'RPN3: label_encode(fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs)', 'rpn_3_feature_2': 'RPN3: sons_occupation cross rpn_3_feature_1'}
2025-10-13 20:08:54,124 - INFO - new_val_acc = 0.9393939393939394
2025-10-13 20:08:54,124 - INFO - new_test_acc = 0.9612068965517241
2025-10-13 20:08:54,643 - INFO - dropped columns = ['counts_for_sons_first_occupation', 'counts_for_sons_first_occupation_sqrt', 'sons_occupation', 'counts_for_sons_first_occupation_counts_for_sons_first_occupation_sqrt_divide_log', 'sons_occupation_fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs_label_encode_cross']
2025-10-13 20:08:55,076 - INFO - sel_val_acc = 0.9393939393939394
2025-10-13 20:08:55,076 - INFO - sel_test_acc = 0.9612068965517241
2025-10-13 20:08:55,076 - INFO - ops_string = counts_for_sons_first_occupation counts_for_sons_first_occupation_sqrt divide log, race label_encode counts_for_sons_first_occupation multiply, sons_occupation fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs label_encode cross
2025-10-13 20:08:55,076 - INFO - Time used for iteration 4: 3.12 seconds
2025-10-13 20:08:55,076 - INFO - Total token usage = 4518
2025-10-13 20:08:55,076 - INFO - ========== Iteration 5/10 ==========
2025-10-13 20:08:55,094 - INFO - Initial prompt: You are an expert datascientist working to improve predictions. 
You perform feature engineering that generate additional columns that are useful for a downstream task.

Task: The aim of this dataset is to study The Effects of Family Disruption on Social Mobility. Predict the counts for son's current occupation. We converts the numeric target feature to a two-class nominal target feature by computing the mean and classifying all instances with a lower target value as positive ('P') and all others as negative ('N').

Features:
- counts_for_sons_first_occupation: counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers. (numerical), range = [0.0, 746.3], Q1 = 0.5, Median = 3.0, Q3 = 11.9, Mean = 19.3561, Std = 51.3517
- counts_for_sons_first_occupation_sqrt:  (numerical), range = [0.0, 27.31849190566712], Q1 = 0.7071067811865476, Median = 1.7320508075688772, Q3 = 3.449637662132068, Mean = 2.7840, Std = 3.4092
- race: race (categorical), categories = [black, white]
- fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs:  (numerical), range = [0, 16], Q1 = 4.0, Median = 8.0, Q3 = 12.0, Mean = 7.7734, Std = 4.7979
- sons_occupation: son's occupation (categorical), categories = [Professional_Self-Employed, Craftsman-Construction, Professional-Salaried, Clerk, Farm_Laborer, Craftsman-Manufacturing, Laborer-Nonmanufacturing, Operative-Manufacturing, Service_Worker, Proprietor, Salesman-Nonretail, Craftsmen-Other, Manager, Farmer/Farm_Manager, Laborer-Manufacturing, Operative-Nonmanufacturing, Salesman-Retail]
- family_structure: family structure (categorical), categories = [intact, nonintact]

Data Examples:
counts_for_sons_first_occupation is 44.2. counts_for_sons_first_occupation_sqrt is 6.648308055437865. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 0. sons_occupation is Clerk. family_structure is intact.
Answer: 0
counts_for_sons_first_occupation is 115.6. counts_for_sons_first_occupation_sqrt is 10.75174404457249. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 10. sons_occupation is Operative-Nonmanufacturing. family_structure is intact.
Answer: 0
counts_for_sons_first_occupation is 0.7. counts_for_sons_first_occupation_sqrt is 0.8366600265340756. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 15. sons_occupation is Salesman-Retail. family_structure is nonintact.
Answer: 1
counts_for_sons_first_occupation is 1.8. counts_for_sons_first_occupation_sqrt is 1.3416407864998738. race is black. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 6. sons_occupation is Laborer-Manufacturing. family_structure is intact.
Answer: 1


Operators:
square, sqrt, cosine, sine, tangent, exp, cube, log, reciprocal, sigmoid, abs, negate, zscore, minmax, rank, bin, one_hot, label_encode, extract_time, is_weekend, elapsed_time, plus, subtract, multiply, divide, mod, equal, greater, less, max, min, cross, concat, ratio, diff, bin
rolling_mean, lag, cumsum, groupbythenmean, groupbythenmin, groupbythenmax, groupbythenmedian, groupbythenstd, groupbythenrank, target_encoding

2025-10-13 20:08:56,029 - INFO - HTTP Request: POST  "HTTP/1.1 200 OK"
2025-10-13 20:08:56,032 - INFO - Token Usage:{'prompt_tokens': 1130, 'completion_tokens': 49, 'total_tokens': 1179}
2025-10-13 20:08:56,032 - INFO - LLM Output: {counts_for_sons_first_occupation race groupbythenmean, counts_for_sons_first_occupation_sqrt family_structure cross, fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs sons_occupation groupbythenstd}
2025-10-13 20:08:56,048 - INFO - 
--- RPN处理错误汇总 ---
2025-10-13 20:08:56,048 - INFO - - 警告: RPN1 特征 'rpn_1_feature_1' 处理失败，跳过。错误: agg function failed [how->mean,dtype->object]
2025-10-13 20:08:56,048 - INFO - - 警告: RPN3 特征 'rpn_3_feature_1' 处理失败，跳过。错误: could not convert string to float: 'Professional_Self-Employed'
2025-10-13 20:08:56,049 - INFO - Success Operators:
[{'new_feature_name': 'rpn_2_feature_1', 'operator': 'cross', 'feature1': 'counts_for_sons_first_occupation_sqrt', 'feature2': 'family_structure', 'description': 'RPN2: counts_for_sons_first_occupation_sqrt cross family_structure'}]
2025-10-13 20:08:56,051 - INFO - 
--- RPN处理错误汇总 ---
2025-10-13 20:08:56,052 - INFO - - 警告: RPN1 特征 'rpn_1_feature_1' 处理失败，跳过。错误: agg function failed [how->mean,dtype->object]
2025-10-13 20:08:56,052 - INFO - - 警告: RPN3 特征 'rpn_3_feature_1' 处理失败，跳过。错误: could not convert string to float: 'Clerk'
2025-10-13 20:08:56,055 - INFO - 
--- RPN处理错误汇总 ---
2025-10-13 20:08:56,055 - INFO - - 警告: RPN1 特征 'rpn_1_feature_1' 处理失败，跳过。错误: agg function failed [how->mean,dtype->object]
2025-10-13 20:08:56,055 - INFO - - 警告: RPN3 特征 'rpn_3_feature_1' 处理失败，跳过。错误: could not convert string to float: 'Service_Worker'
2025-10-13 20:08:56,056 - INFO - Extracted Metadata: {'sons_occupation': "son's occupation", 'family_structure': 'family structure', 'race': 'race', 'counts_for_sons_first_occupation': "counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers.", 'rpn_1_feature_1': 'RPN1: sqrt(counts_for_sons_first_occupation)', 'rpn_1_feature_2': 'RPN1: label_encode(sons_occupation)', 'rpn_2_feature_1': 'RPN2: counts_for_sons_first_occupation_sqrt cross family_structure', 'rpn_2_feature_2': 'RPN2: label_encode(rpn_2_feature_1)'}
2025-10-13 20:08:56,425 - INFO - new_val_acc = 0.948051948051948
2025-10-13 20:08:56,425 - INFO - new_test_acc = 0.9655172413793104
2025-10-13 20:08:56,769 - INFO - dropped columns = []
2025-10-13 20:08:56,769 - INFO - ops_string = counts_for_sons_first_occupation race groupbythenmean, counts_for_sons_first_occupation_sqrt family_structure cross, fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs sons_occupation groupbythenstd
2025-10-13 20:08:56,769 - INFO - Time used for iteration 5: 1.69 seconds
2025-10-13 20:08:56,769 - INFO - Total token usage = 5697
2025-10-13 20:08:56,769 - INFO - ========== Iteration 6/10 ==========
2025-10-13 20:08:56,781 - INFO - Initial prompt: You are an expert datascientist working to improve predictions. 
You perform feature engineering that generate additional columns that are useful for a downstream task.

Task: The aim of this dataset is to study The Effects of Family Disruption on Social Mobility. Predict the counts for son's current occupation. We converts the numeric target feature to a two-class nominal target feature by computing the mean and classifying all instances with a lower target value as positive ('P') and all others as negative ('N').

Features:
- counts_for_sons_first_occupation: counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers. (numerical), range = [0.0, 746.3], Q1 = 0.5, Median = 3.0, Q3 = 11.9, Mean = 19.3561, Std = 51.3517
- counts_for_sons_first_occupation_sqrt:  (numerical), range = [0.0, 27.31849190566712], Q1 = 0.7071067811865476, Median = 1.7320508075688772, Q3 = 3.449637662132068, Mean = 2.7840, Std = 3.4092
- race: race (categorical), categories = [black, white]
- fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs:  (numerical), range = [0, 16], Q1 = 4.0, Median = 8.0, Q3 = 12.0, Mean = 7.7734, Std = 4.7979
- sons_occupation: son's occupation (categorical), categories = [Professional_Self-Employed, Craftsman-Construction, Professional-Salaried, Clerk, Farm_Laborer, Craftsman-Manufacturing, Laborer-Nonmanufacturing, Operative-Manufacturing, Service_Worker, Proprietor, Salesman-Nonretail, Craftsmen-Other, Manager, Farmer/Farm_Manager, Laborer-Manufacturing, Operative-Nonmanufacturing, Salesman-Retail]
- family_structure: family structure (categorical), categories = [intact, nonintact]

Data Examples:
counts_for_sons_first_occupation is 40.8. counts_for_sons_first_occupation_sqrt is 6.387487769068525. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 10. sons_occupation is Operative-Nonmanufacturing. family_structure is intact.
Answer: 0
counts_for_sons_first_occupation is 46.4. counts_for_sons_first_occupation_sqrt is 6.81175454637056. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 15. sons_occupation is Salesman-Retail. family_structure is intact.
Answer: 0
counts_for_sons_first_occupation is 11.4. counts_for_sons_first_occupation_sqrt is 3.3763886032268267. race is black. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 0. sons_occupation is Clerk. family_structure is intact.
Answer: 1
counts_for_sons_first_occupation is 4.2. counts_for_sons_first_occupation_sqrt is 2.04939015319192. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 4. sons_occupation is Farm_Laborer. family_structure is nonintact.
Answer: 1


Operators:
square, sqrt, cosine, sine, tangent, exp, cube, log, reciprocal, sigmoid, abs, negate, zscore, minmax, rank, bin, one_hot, label_encode, extract_time, is_weekend, elapsed_time, plus, subtract, multiply, divide, mod, equal, greater, less, max, min, cross, concat, ratio, diff, bin
rolling_mean, lag, cumsum, groupbythenmean, groupbythenmin, groupbythenmax, groupbythenmedian, groupbythenstd, groupbythenrank, target_encoding

2025-10-13 20:08:57,945 - INFO - HTTP Request: POST  "HTTP/1.1 200 OK"
2025-10-13 20:08:57,946 - INFO - Token Usage:{'prompt_tokens': 1128, 'completion_tokens': 43, 'total_tokens': 1171}
2025-10-13 20:08:57,946 - INFO - LLM Output: {sons_occupation label_encode counts_for_sons_first_occupation_sqrt multiply, race counts_for_sons_first_occupation concat label_encode, family_structure counts_for_sons_first_occupation cross label_encode}
2025-10-13 20:08:57,962 - INFO - Success Operators:
[{'new_feature_name': 'rpn_1_feature_1', 'operator': 'label_encode', 'feature1': 'sons_occupation', 'feature2': None, 'description': 'RPN1: label_encode(sons_occupation)'}, {'new_feature_name': 'rpn_1_feature_2', 'operator': 'multiply', 'feature1': 'rpn_1_feature_1', 'feature2': 'counts_for_sons_first_occupation_sqrt', 'description': 'RPN1: rpn_1_feature_1 multiply counts_for_sons_first_occupation_sqrt'}, {'new_feature_name': 'rpn_2_feature_1', 'operator': 'concat', 'feature1': 'race', 'feature2': 'counts_for_sons_first_occupation', 'description': 'RPN2: race concat counts_for_sons_first_occupation'}, {'new_feature_name': 'rpn_2_feature_2', 'operator': 'label_encode', 'feature1': 'rpn_2_feature_1', 'feature2': None, 'description': 'RPN2: label_encode(rpn_2_feature_1)'}, {'new_feature_name': 'rpn_3_feature_1', 'operator': 'cross', 'feature1': 'family_structure', 'feature2': 'counts_for_sons_first_occupation', 'description': 'RPN3: family_structure cross counts_for_sons_first_occupation'}, {'new_feature_name': 'rpn_3_feature_2', 'operator': 'label_encode', 'feature1': 'rpn_3_feature_1', 'feature2': None, 'description': 'RPN3: label_encode(rpn_3_feature_1)'}]
2025-10-13 20:08:57,975 - INFO - Extracted Metadata: {'sons_occupation': "son's occupation", 'family_structure': 'family structure', 'race': 'race', 'counts_for_sons_first_occupation': "counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers.", 'rpn_1_feature_1': 'RPN1: label_encode(sons_occupation)', 'rpn_1_feature_2': 'RPN1: rpn_1_feature_1 multiply counts_for_sons_first_occupation_sqrt', 'rpn_2_feature_1': 'RPN2: race concat counts_for_sons_first_occupation', 'rpn_2_feature_2': 'RPN2: label_encode(rpn_2_feature_1)', 'rpn_3_feature_1': 'RPN3: family_structure cross counts_for_sons_first_occupation', 'rpn_3_feature_2': 'RPN3: label_encode(rpn_3_feature_1)'}
2025-10-13 20:08:58,348 - INFO - new_val_acc = 0.948051948051948
2025-10-13 20:08:58,348 - INFO - new_test_acc = 0.9439655172413793
2025-10-13 20:08:58,806 - INFO - dropped columns = []
2025-10-13 20:08:58,807 - INFO - ops_string = sons_occupation label_encode counts_for_sons_first_occupation_sqrt multiply, race counts_for_sons_first_occupation concat label_encode, family_structure counts_for_sons_first_occupation cross label_encode
2025-10-13 20:08:58,807 - INFO - Time used for iteration 6: 2.04 seconds
2025-10-13 20:08:58,807 - INFO - Total token usage = 6868
2025-10-13 20:08:58,807 - INFO - ========== Iteration 7/10 ==========
2025-10-13 20:08:58,819 - INFO - Initial prompt: You are an expert datascientist working to improve predictions. 
You perform feature engineering that generate additional columns that are useful for a downstream task.

Task: The aim of this dataset is to study The Effects of Family Disruption on Social Mobility. Predict the counts for son's current occupation. We converts the numeric target feature to a two-class nominal target feature by computing the mean and classifying all instances with a lower target value as positive ('P') and all others as negative ('N').

Features:
- counts_for_sons_first_occupation: counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers. (numerical), range = [0.0, 746.3], Q1 = 0.5, Median = 3.0, Q3 = 11.9, Mean = 19.3561, Std = 51.3517
- counts_for_sons_first_occupation_sqrt:  (numerical), range = [0.0, 27.31849190566712], Q1 = 0.7071067811865476, Median = 1.7320508075688772, Q3 = 3.449637662132068, Mean = 2.7840, Std = 3.4092
- race: race (categorical), categories = [black, white]
- fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs:  (numerical), range = [0, 16], Q1 = 4.0, Median = 8.0, Q3 = 12.0, Mean = 7.7734, Std = 4.7979
- sons_occupation: son's occupation (categorical), categories = [Professional_Self-Employed, Craftsman-Construction, Professional-Salaried, Clerk, Farm_Laborer, Craftsman-Manufacturing, Laborer-Nonmanufacturing, Operative-Manufacturing, Service_Worker, Proprietor, Salesman-Nonretail, Craftsmen-Other, Manager, Farmer/Farm_Manager, Laborer-Manufacturing, Operative-Nonmanufacturing, Salesman-Retail]
- family_structure: family structure (categorical), categories = [intact, nonintact]

Data Examples:
counts_for_sons_first_occupation is 54.5. counts_for_sons_first_occupation_sqrt is 7.3824115301167. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 8. sons_occupation is Manager. family_structure is intact.
Answer: 0
counts_for_sons_first_occupation is 82.9. counts_for_sons_first_occupation_sqrt is 9.10494371207203. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 9. sons_occupation is Operative-Manufacturing. family_structure is intact.
Answer: 0
counts_for_sons_first_occupation is 2.1. counts_for_sons_first_occupation_sqrt is 1.449137674618944. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 14. sons_occupation is Salesman-Nonretail. family_structure is nonintact.
Answer: 1
counts_for_sons_first_occupation is 16.9. counts_for_sons_first_occupation_sqrt is 4.110960958218893. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 11. sons_occupation is Professional-Salaried. family_structure is nonintact.
Answer: 1


Operators:
square, sqrt, cosine, sine, tangent, exp, cube, log, reciprocal, sigmoid, abs, negate, zscore, minmax, rank, bin, one_hot, label_encode, extract_time, is_weekend, elapsed_time, plus, subtract, multiply, divide, mod, equal, greater, less, max, min, cross, concat, ratio, diff, bin
rolling_mean, lag, cumsum, groupbythenmean, groupbythenmin, groupbythenmax, groupbythenmedian, groupbythenstd, groupbythenrank, target_encoding

2025-10-13 20:09:00,329 - INFO - HTTP Request: POST  "HTTP/1.1 200 OK"
2025-10-13 20:09:00,335 - INFO - Token Usage:{'prompt_tokens': 1130, 'completion_tokens': 57, 'total_tokens': 1187}
2025-10-13 20:09:00,335 - INFO - LLM Output: {counts_for_sons_first_occupation counts_for_sons_first_occupation_sqrt divide log, race counts_for_sons_first_occupation groupbythenmean, fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs counts_for_sons_first_occupation multiply sqrt}
2025-10-13 20:09:00,350 - INFO - Success Operators:
[{'new_feature_name': 'rpn_1_feature_1', 'operator': 'divide', 'feature1': 'counts_for_sons_first_occupation', 'feature2': 'counts_for_sons_first_occupation_sqrt', 'description': 'RPN1: counts_for_sons_first_occupation divide counts_for_sons_first_occupation_sqrt'}, {'new_feature_name': 'rpn_1_feature_2', 'operator': 'log', 'feature1': 'rpn_1_feature_1', 'feature2': None, 'description': 'RPN1: log(rpn_1_feature_1)'}, {'new_feature_name': 'rpn_2_feature_1', 'operator': 'groupbythenmean', 'feature1': 'race', 'feature2': 'counts_for_sons_first_occupation', 'description': 'RPN2: race groupbythenmean counts_for_sons_first_occupation'}, {'new_feature_name': 'rpn_3_feature_1', 'operator': 'multiply', 'feature1': 'fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs', 'feature2': 'counts_for_sons_first_occupation', 'description': 'RPN3: fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs multiply counts_for_sons_first_occupation'}, {'new_feature_name': 'rpn_3_feature_2', 'operator': 'sqrt', 'feature1': 'rpn_3_feature_1', 'feature2': None, 'description': 'RPN3: sqrt(rpn_3_feature_1)'}]
2025-10-13 20:09:00,360 - INFO - Extracted Metadata: {'sons_occupation': "son's occupation", 'family_structure': 'family structure', 'race': 'race', 'counts_for_sons_first_occupation': "counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers.", 'rpn_1_feature_1': 'RPN1: counts_for_sons_first_occupation divide counts_for_sons_first_occupation_sqrt', 'rpn_1_feature_2': 'RPN1: log(rpn_1_feature_1)', 'rpn_2_feature_1': 'RPN2: race groupbythenmean counts_for_sons_first_occupation', 'rpn_2_feature_2': 'RPN2: label_encode(rpn_2_feature_1)', 'rpn_3_feature_1': 'RPN3: fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs multiply counts_for_sons_first_occupation', 'rpn_3_feature_2': 'RPN3: sqrt(rpn_3_feature_1)'}
2025-10-13 20:09:00,735 - INFO - new_val_acc = 0.9523809523809523
2025-10-13 20:09:00,735 - INFO - new_test_acc = 0.9741379310344828
2025-10-13 20:09:01,187 - INFO - dropped columns = []
2025-10-13 20:09:01,187 - INFO - ops_string = counts_for_sons_first_occupation counts_for_sons_first_occupation_sqrt divide log, race counts_for_sons_first_occupation groupbythenmean, fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs counts_for_sons_first_occupation multiply sqrt
2025-10-13 20:09:01,187 - INFO - Time used for iteration 7: 2.38 seconds
2025-10-13 20:09:01,187 - INFO - Total token usage = 8055
2025-10-13 20:09:01,187 - INFO - ========== Iteration 8/10 ==========
2025-10-13 20:09:01,212 - INFO - Initial prompt: You are an expert datascientist working to improve predictions. 
You perform feature engineering that generate additional columns that are useful for a downstream task.

Task: The aim of this dataset is to study The Effects of Family Disruption on Social Mobility. Predict the counts for son's current occupation. We converts the numeric target feature to a two-class nominal target feature by computing the mean and classifying all instances with a lower target value as positive ('P') and all others as negative ('N').

Features:
- counts_for_sons_first_occupation: counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers. (numerical), range = [0.0, 746.3], Q1 = 0.5, Median = 3.0, Q3 = 11.9, Mean = 19.3561, Std = 51.3517
- counts_for_sons_first_occupation_sqrt:  (numerical), range = [0.0, 27.31849190566712], Q1 = 0.7071067811865476, Median = 1.7320508075688772, Q3 = 3.449637662132068, Mean = 2.7840, Std = 3.4092
- race: race (categorical), categories = [black, white]
- fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs:  (numerical), range = [0, 16], Q1 = 4.0, Median = 8.0, Q3 = 12.0, Mean = 7.7734, Std = 4.7979
- sons_occupation: son's occupation (categorical), categories = [Professional_Self-Employed, Craftsman-Construction, Professional-Salaried, Clerk, Farm_Laborer, Craftsman-Manufacturing, Laborer-Nonmanufacturing, Operative-Manufacturing, Service_Worker, Proprietor, Salesman-Nonretail, Craftsmen-Other, Manager, Farmer/Farm_Manager, Laborer-Manufacturing, Operative-Nonmanufacturing, Salesman-Retail]
- family_structure: family structure (categorical), categories = [intact, nonintact]

Data Examples:
counts_for_sons_first_occupation is 62.6. counts_for_sons_first_occupation_sqrt is 7.912016177940993. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 3. sons_occupation is Craftsmen-Other. family_structure is intact.
Answer: 0
counts_for_sons_first_occupation is 154.3. counts_for_sons_first_occupation_sqrt is 12.421755109484328. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 1. sons_occupation is Craftsman-Construction. family_structure is intact.
Answer: 0
counts_for_sons_first_occupation is 1.4. counts_for_sons_first_occupation_sqrt is 1.1832159566199232. race is black. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 8. sons_occupation is Manager. family_structure is intact.
Answer: 1
counts_for_sons_first_occupation is 2.7. counts_for_sons_first_occupation_sqrt is 1.6431676725154984. race is black. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 1. sons_occupation is Craftsman-Construction. family_structure is intact.
Answer: 1


Operators:
square, sqrt, cosine, sine, tangent, exp, cube, log, reciprocal, sigmoid, abs, negate, zscore, minmax, rank, bin, one_hot, label_encode, extract_time, is_weekend, elapsed_time, plus, subtract, multiply, divide, mod, equal, greater, less, max, min, cross, concat, ratio, diff, bin
rolling_mean, lag, cumsum, groupbythenmean, groupbythenmin, groupbythenmax, groupbythenmedian, groupbythenstd, groupbythenrank, target_encoding

2025-10-13 20:09:02,607 - INFO - HTTP Request: POST  "HTTP/1.1 200 OK"
2025-10-13 20:09:02,613 - INFO - Token Usage:{'prompt_tokens': 1125, 'completion_tokens': 47, 'total_tokens': 1172}
2025-10-13 20:09:02,613 - INFO - LLM Output: {counts_for_sons_first_occupation sqrt, fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs counts_for_sons_first_occupation multiply, counts_for_sons_first_occupation family_structure groupbythenmean}
2025-10-13 20:09:02,626 - INFO - 
--- RPN处理错误汇总 ---
2025-10-13 20:09:02,626 - INFO - - 警告: RPN3 特征 'rpn_3_feature_1' 处理失败，跳过。错误: agg function failed [how->mean,dtype->object]
2025-10-13 20:09:02,643 - INFO - Success Operators:
[{'new_feature_name': 'rpn_1_feature_1', 'operator': 'sqrt', 'feature1': 'counts_for_sons_first_occupation', 'feature2': None, 'description': 'RPN1: sqrt(counts_for_sons_first_occupation)'}, {'new_feature_name': 'rpn_2_feature_1', 'operator': 'multiply', 'feature1': 'fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs', 'feature2': 'counts_for_sons_first_occupation', 'description': 'RPN2: fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs multiply counts_for_sons_first_occupation'}]
2025-10-13 20:09:02,646 - INFO - 
--- RPN处理错误汇总 ---
2025-10-13 20:09:02,646 - INFO - - 警告: RPN3 特征 'rpn_3_feature_1' 处理失败，跳过。错误: agg function failed [how->mean,dtype->object]
2025-10-13 20:09:02,649 - INFO - 
--- RPN处理错误汇总 ---
2025-10-13 20:09:02,649 - INFO - - 警告: RPN3 特征 'rpn_3_feature_1' 处理失败，跳过。错误: agg function failed [how->mean,dtype->object]
2025-10-13 20:09:02,650 - INFO - Extracted Metadata: {'sons_occupation': "son's occupation", 'family_structure': 'family structure', 'race': 'race', 'counts_for_sons_first_occupation': "counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers.", 'rpn_1_feature_1': 'RPN1: sqrt(counts_for_sons_first_occupation)', 'rpn_1_feature_2': 'RPN1: label_encode(sons_occupation)', 'rpn_2_feature_1': 'RPN2: fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs multiply counts_for_sons_first_occupation', 'rpn_2_feature_2': 'RPN2: label_encode(rpn_2_feature_1)'}
2025-10-13 20:09:02,987 - INFO - new_val_acc = 0.9523809523809523
2025-10-13 20:09:02,988 - INFO - new_test_acc = 0.9698275862068966
2025-10-13 20:09:03,334 - INFO - dropped columns = []
2025-10-13 20:09:03,334 - INFO - ops_string = counts_for_sons_first_occupation sqrt, fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs counts_for_sons_first_occupation multiply, counts_for_sons_first_occupation family_structure groupbythenmean
2025-10-13 20:09:03,334 - INFO - Time used for iteration 8: 2.15 seconds
2025-10-13 20:09:03,334 - INFO - Total token usage = 9227
2025-10-13 20:09:03,334 - INFO - ========== Iteration 9/10 ==========
2025-10-13 20:09:03,346 - INFO - Initial prompt: You are an expert datascientist working to improve predictions. 
You perform feature engineering that generate additional columns that are useful for a downstream task.

Task: The aim of this dataset is to study The Effects of Family Disruption on Social Mobility. Predict the counts for son's current occupation. We converts the numeric target feature to a two-class nominal target feature by computing the mean and classifying all instances with a lower target value as positive ('P') and all others as negative ('N').

Features:
- counts_for_sons_first_occupation: counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers. (numerical), range = [0.0, 746.3], Q1 = 0.5, Median = 3.0, Q3 = 11.9, Mean = 19.3561, Std = 51.3517
- counts_for_sons_first_occupation_sqrt:  (numerical), range = [0.0, 27.31849190566712], Q1 = 0.7071067811865476, Median = 1.7320508075688772, Q3 = 3.449637662132068, Mean = 2.7840, Std = 3.4092
- race: race (categorical), categories = [black, white]
- fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs:  (numerical), range = [0, 16], Q1 = 4.0, Median = 8.0, Q3 = 12.0, Mean = 7.7734, Std = 4.7979
- sons_occupation: son's occupation (categorical), categories = [Professional_Self-Employed, Craftsman-Construction, Professional-Salaried, Clerk, Farm_Laborer, Craftsman-Manufacturing, Laborer-Nonmanufacturing, Operative-Manufacturing, Service_Worker, Proprietor, Salesman-Nonretail, Craftsmen-Other, Manager, Farmer/Farm_Manager, Laborer-Manufacturing, Operative-Nonmanufacturing, Salesman-Retail]
- family_structure: family structure (categorical), categories = [intact, nonintact]

Data Examples:
counts_for_sons_first_occupation is 3.1. counts_for_sons_first_occupation_sqrt is 1.760681686165901. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 8. sons_occupation is Manager. family_structure is intact.
Answer: 0
counts_for_sons_first_occupation is 157.7. counts_for_sons_first_occupation_sqrt is 12.557866060760482. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 0. sons_occupation is Clerk. family_structure is intact.
Answer: 0
counts_for_sons_first_occupation is 1.5. counts_for_sons_first_occupation_sqrt is 1.224744871391589. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 3. sons_occupation is Craftsmen-Other. family_structure is nonintact.
Answer: 1
counts_for_sons_first_occupation is 9.0. counts_for_sons_first_occupation_sqrt is 3.0. race is black. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 10. sons_occupation is Operative-Nonmanufacturing. family_structure is nonintact.
Answer: 1


Operators:
square, sqrt, cosine, sine, tangent, exp, cube, log, reciprocal, sigmoid, abs, negate, zscore, minmax, rank, bin, one_hot, label_encode, extract_time, is_weekend, elapsed_time, plus, subtract, multiply, divide, mod, equal, greater, less, max, min, cross, concat, ratio, diff, bin
rolling_mean, lag, cumsum, groupbythenmean, groupbythenmin, groupbythenmax, groupbythenmedian, groupbythenstd, groupbythenrank, target_encoding

2025-10-13 20:09:05,508 - INFO - HTTP Request: POST  "HTTP/1.1 200 OK"
2025-10-13 20:09:05,652 - INFO - Token Usage:{'prompt_tokens': 1122, 'completion_tokens': 43, 'total_tokens': 1165}
2025-10-13 20:09:05,652 - INFO - LLM Output: {counts_for_sons_first_occupation race groupbythenmean, counts_for_sons_first_occupation race groupbythenstd, counts_for_sons_first_occupation sigmoid sons_occupation label_encode cross}
2025-10-13 20:09:05,663 - INFO - 
--- RPN处理错误汇总 ---
2025-10-13 20:09:05,663 - INFO - - 警告: RPN1 特征 'rpn_1_feature_1' 处理失败，跳过。错误: agg function failed [how->mean,dtype->object]
2025-10-13 20:09:05,663 - INFO - - 警告: RPN2 特征 'rpn_2_feature_1' 处理失败，跳过。错误: could not convert string to float: 'black'
2025-10-13 20:09:05,664 - INFO - Success Operators:
[{'new_feature_name': 'rpn_3_feature_1', 'operator': 'sigmoid', 'feature1': 'counts_for_sons_first_occupation', 'feature2': None, 'description': 'RPN3: sigmoid(counts_for_sons_first_occupation)'}, {'new_feature_name': 'rpn_3_feature_2', 'operator': 'label_encode', 'feature1': 'sons_occupation', 'feature2': None, 'description': 'RPN3: label_encode(sons_occupation)'}, {'new_feature_name': 'rpn_3_feature_3', 'operator': 'cross', 'feature1': 'rpn_3_feature_1', 'feature2': 'rpn_3_feature_2', 'description': 'RPN3: rpn_3_feature_1 cross rpn_3_feature_2'}]
2025-10-13 20:09:05,669 - INFO - 
--- RPN处理错误汇总 ---
2025-10-13 20:09:05,669 - INFO - - 警告: RPN1 特征 'rpn_1_feature_1' 处理失败，跳过。错误: agg function failed [how->mean,dtype->object]
2025-10-13 20:09:05,669 - INFO - - 警告: RPN2 特征 'rpn_2_feature_1' 处理失败，跳过。错误: could not convert string to float: 'black'
2025-10-13 20:09:05,675 - INFO - 
--- RPN处理错误汇总 ---
2025-10-13 20:09:05,675 - INFO - - 警告: RPN1 特征 'rpn_1_feature_1' 处理失败，跳过。错误: agg function failed [how->mean,dtype->object]
2025-10-13 20:09:05,675 - INFO - - 警告: RPN2 特征 'rpn_2_feature_1' 处理失败，跳过。错误: could not convert string to float: 'white'
2025-10-13 20:09:05,676 - INFO - Extracted Metadata: {'sons_occupation': "son's occupation", 'family_structure': 'family structure', 'race': 'race', 'counts_for_sons_first_occupation': "counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers.", 'rpn_1_feature_1': 'RPN1: sqrt(counts_for_sons_first_occupation)', 'rpn_1_feature_2': 'RPN1: label_encode(sons_occupation)', 'rpn_2_feature_1': 'RPN2: fathers_occupation cross sons_occupation', 'rpn_2_feature_2': 'RPN2: label_encode(rpn_2_feature_1)', 'rpn_3_feature_1': 'RPN3: sigmoid(counts_for_sons_first_occupation)', 'rpn_3_feature_2': 'RPN3: label_encode(sons_occupation)', 'rpn_3_feature_3': 'RPN3: rpn_3_feature_1 cross rpn_3_feature_2'}
2025-10-13 20:09:06,160 - INFO - new_val_acc = 0.9523809523809523
2025-10-13 20:09:06,160 - INFO - new_test_acc = 0.9655172413793104
2025-10-13 20:09:06,606 - INFO - dropped columns = []
2025-10-13 20:09:06,606 - INFO - ops_string = counts_for_sons_first_occupation race groupbythenmean, counts_for_sons_first_occupation race groupbythenstd, counts_for_sons_first_occupation sigmoid sons_occupation label_encode cross
2025-10-13 20:09:06,607 - INFO - Time used for iteration 9: 3.27 seconds
2025-10-13 20:09:06,607 - INFO - Total token usage = 10392
2025-10-13 20:09:06,607 - INFO - ========== Iteration 10/10 ==========
2025-10-13 20:09:06,620 - INFO - Initial prompt: You are an expert datascientist working to improve predictions. 
You perform feature engineering that generate additional columns that are useful for a downstream task.

Task: The aim of this dataset is to study The Effects of Family Disruption on Social Mobility. Predict the counts for son's current occupation. We converts the numeric target feature to a two-class nominal target feature by computing the mean and classifying all instances with a lower target value as positive ('P') and all others as negative ('N').

Features:
- counts_for_sons_first_occupation: counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers. (numerical), range = [0.0, 746.3], Q1 = 0.5, Median = 3.0, Q3 = 11.9, Mean = 19.3561, Std = 51.3517
- counts_for_sons_first_occupation_sqrt:  (numerical), range = [0.0, 27.31849190566712], Q1 = 0.7071067811865476, Median = 1.7320508075688772, Q3 = 3.449637662132068, Mean = 2.7840, Std = 3.4092
- race: race (categorical), categories = [black, white]
- fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs:  (numerical), range = [0, 16], Q1 = 4.0, Median = 8.0, Q3 = 12.0, Mean = 7.7734, Std = 4.7979
- sons_occupation: son's occupation (categorical), categories = [Professional_Self-Employed, Craftsman-Construction, Professional-Salaried, Clerk, Farm_Laborer, Craftsman-Manufacturing, Laborer-Nonmanufacturing, Operative-Manufacturing, Service_Worker, Proprietor, Salesman-Nonretail, Craftsmen-Other, Manager, Farmer/Farm_Manager, Laborer-Manufacturing, Operative-Nonmanufacturing, Salesman-Retail]
- family_structure: family structure (categorical), categories = [intact, nonintact]

Data Examples:
counts_for_sons_first_occupation is 54.5. counts_for_sons_first_occupation_sqrt is 7.3824115301167. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 8. sons_occupation is Manager. family_structure is intact.
Answer: 0
counts_for_sons_first_occupation is 26.5. counts_for_sons_first_occupation_sqrt is 5.1478150704935. race is white. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 0. sons_occupation is Clerk. family_structure is nonintact.
Answer: 0
counts_for_sons_first_occupation is 3.1. counts_for_sons_first_occupation_sqrt is 1.760681686165901. race is black. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 11. sons_occupation is Professional-Salaried. family_structure is nonintact.
Answer: 1
counts_for_sons_first_occupation is 1.3. counts_for_sons_first_occupation_sqrt is 1.140175425099138. race is black. fathers_occupation_label_encode_sons_occupation_label_encode_minus_abs is 11. sons_occupation is Professional-Salaried. family_structure is intact.
Answer: 1


Operators:
square, sqrt, cosine, sine, tangent, exp, cube, log, reciprocal, sigmoid, abs, negate, zscore, minmax, rank, bin, one_hot, label_encode, extract_time, is_weekend, elapsed_time, plus, subtract, multiply, divide, mod, equal, greater, less, max, min, cross, concat, ratio, diff, bin
rolling_mean, lag, cumsum, groupbythenmean, groupbythenmin, groupbythenmax, groupbythenmedian, groupbythenstd, groupbythenrank, target_encoding

2025-10-13 20:09:07,838 - INFO - HTTP Request: POST  "HTTP/1.1 200 OK"
2025-10-13 20:09:07,840 - INFO - Token Usage:{'prompt_tokens': 1124, 'completion_tokens': 38, 'total_tokens': 1162}
2025-10-13 20:09:07,840 - INFO - LLM Output: {counts_for_sons_first_occupation sqrt negate abs, race counts_for_sons_first_occupation groupbythenmean, counts_for_sons_first_occupation race label_encode multiply}
2025-10-13 20:09:07,856 - INFO - Success Operators:
[{'new_feature_name': 'rpn_1_feature_1', 'operator': 'sqrt', 'feature1': 'counts_for_sons_first_occupation', 'feature2': None, 'description': 'RPN1: sqrt(counts_for_sons_first_occupation)'}, {'new_feature_name': 'rpn_1_feature_2', 'operator': 'negate', 'feature1': 'rpn_1_feature_1', 'feature2': None, 'description': 'RPN1: negate(rpn_1_feature_1)'}, {'new_feature_name': 'rpn_1_feature_3', 'operator': 'abs', 'feature1': 'rpn_1_feature_2', 'feature2': None, 'description': 'RPN1: abs(rpn_1_feature_2)'}, {'new_feature_name': 'rpn_2_feature_1', 'operator': 'groupbythenmean', 'feature1': 'race', 'feature2': 'counts_for_sons_first_occupation', 'description': 'RPN2: race groupbythenmean counts_for_sons_first_occupation'}, {'new_feature_name': 'rpn_3_feature_1', 'operator': 'label_encode', 'feature1': 'race', 'feature2': None, 'description': 'RPN3: label_encode(race)'}, {'new_feature_name': 'rpn_3_feature_2', 'operator': 'multiply', 'feature1': 'counts_for_sons_first_occupation', 'feature2': 'rpn_3_feature_1', 'description': 'RPN3: counts_for_sons_first_occupation multiply rpn_3_feature_1'}]
2025-10-13 20:09:07,866 - INFO - Extracted Metadata: {'sons_occupation': "son's occupation", 'family_structure': 'family structure', 'race': 'race', 'counts_for_sons_first_occupation': "counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers.", 'rpn_1_feature_1': 'RPN1: sqrt(counts_for_sons_first_occupation)', 'rpn_1_feature_2': 'RPN1: negate(rpn_1_feature_1)', 'rpn_2_feature_1': 'RPN2: race groupbythenmean counts_for_sons_first_occupation', 'rpn_2_feature_2': 'RPN2: label_encode(rpn_2_feature_1)', 'rpn_1_feature_3': 'RPN1: abs(rpn_1_feature_2)', 'rpn_3_feature_1': 'RPN3: label_encode(race)', 'rpn_3_feature_2': 'RPN3: counts_for_sons_first_occupation multiply rpn_3_feature_1'}
2025-10-13 20:09:08,298 - INFO - new_val_acc = 0.935064935064935
2025-10-13 20:09:08,298 - INFO - new_test_acc = 0.9612068965517241
2025-10-13 20:09:08,784 - INFO - dropped columns = ['counts_for_sons_first_occupation_sqrt', 'race', 'counts_for_sons_first_occupation_sqrt_negate_abs', 'race_counts_for_sons_first_occupation_groupbythenmean', 'counts_for_sons_first_occupation_race_label_encode_multiply']
2025-10-13 20:09:09,154 - INFO - sel_val_acc = 0.9523809523809523
2025-10-13 20:09:09,154 - INFO - sel_test_acc = 0.9612068965517241
2025-10-13 20:09:09,155 - INFO - ops_string = counts_for_sons_first_occupation sqrt negate abs, race counts_for_sons_first_occupation groupbythenmean, counts_for_sons_first_occupation race label_encode multiply
2025-10-13 20:09:09,155 - INFO - Time used for iteration 10: 2.55 seconds
2025-10-13 20:09:09,155 - INFO - Total token usage = 11554
2025-10-13 20:09:09,332 - INFO - final_test_acc = 0.9741379310344828
2025-10-13 20:09:09,332 - INFO - Total token usage = 11554
2025-10-13 20:09:09,332 - INFO - Score list = [0.9393939393939394, 0.9523809523809523, 0.9567099567099567]
2025-10-13 20:09:09,333 - INFO - Best performance = 0.9567099567099567
2025-10-13 20:09:09,333 - INFO - Best feature set = {'sons_occupation': "son's occupation", 'family_structure': 'family structure', 'race': 'race', 'counts_for_sons_first_occupation': "counts for son's first occupation. The counts have been weighted to take account of the survey design, which is why they are not integers.", 'rpn_1_feature_1': 'RPN1: sqrt(counts_for_sons_first_occupation)', 'rpn_1_feature_2': 'RPN1: label_encode(sons_occupation)', 'rpn_2_feature_1': 'RPN2: fathers_occupation cross sons_occupation', 'rpn_2_feature_2': 'RPN2: label_encode(rpn_2_feature_1)'}
2025-10-13 20:09:09,333 - INFO - Total time used = 26.09 seconds
2025-10-13 20:09:09,333 - INFO - ========== END ==========
final_test_acc_ag = 0.9655172413793104
========== END ==========
